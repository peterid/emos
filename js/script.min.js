function initCamera(){var a=new JpegCamera("#webcam");document.getElementById("analyse").addEventListener("click",function(){console.log("CAPTURE"),a.capture().upload({api_url:"http://alcwynparker.co.uk/DM/pete/upload.php"}).done(function(a){document.getElementById("response").innerHTML=a,runEmos()}).fail(function(a,b,c){})})}function runEmos(){var a={url:""};$.ajax({url:"https://westus.api.cognitive.microsoft.com/emotion/v1.0/recognize?"+$.param(a),beforeSend:function(a){a.setRequestHeader("Content-Type","application/json"),a.setRequestHeader("Ocp-Apim-Subscription-Key","a1790d020a264312a86686637bb18825")},type:"POST",data:"{'url': 'http://alcwynparker.co.uk/DM/pete/uploads/face.jpg' }"}).done(function(a){if(console.log(a[0]),null!=a[0]){console.log("GOT REAL DATA.");var b=a[0].scores.happiness+a[0].scores.anger+a[0].scores.neutral,c=b/3*10;console.log(a[0].scores.happiness+"   "+a[0].scores.anger+"   "+a[0].scores.neutral),console.log("Average: "+c),happyVal=Math.floor(c),console.log("happy"+happyVal),document.getElementById("happy-result").innerHTML="<p>"+happyVal+"</p>"}else runShitEmos()})}function runShitEmos(){var a={url:""};$.ajax({url:"https://westus.api.cognitive.microsoft.com/emotion/v1.0/recognize?"+$.param(a),beforeSend:function(a){a.setRequestHeader("Content-Type","application/json"),a.setRequestHeader("Ocp-Apim-Subscription-Key","a1790d020a264312a86686637bb18825")},type:"POST",data:"{'url': 'https://ak3.picdn.net/shutterstock/videos/3696824/thumb/9.jpg' }"}).done(function(a){console.log("shit backup data: "+a[0]),console.log("USING BACKUP DATA");var b=a[0].scores.happiness+a[0].scores.anger+a[0].scores.neutral,c=b/3*10;console.log(a[0].scores.happiness+"   "+a[0].scores.anger+"   "+a[0].scores.neutral),console.log("Average: "+c),happyVal=Math.floor(c),console.log("happy"+happyVal),document.getElementById("happy-result").innerHTML="<p>"+happyVal+"</p>"})}function clickHandler(){setTimeout(showModal,6e3)}function showModal(){stages[currentStage].style.display="none",currentStage++,currentStage>=4&&(currentStage=0),stages[currentStage].style.display="block"}function mindfulness(){stages[currentStage].style.display="none",currentStage=5,stages[currentStage].style.display="block"}function music(){stages[currentStage].style.display="none",currentStage=6,stages[currentStage].style.display="block"}function chatbot(){stages[currentStage].style.display="none",currentStage=7,stages[currentStage].style.display="block"}function analyse(){stages[currentStage].style.display="none",currentStage=1,stages[currentStage].style.display="block"}function emotionResult(){stages[currentStage].style.display="none",currentStage=3,stages[currentStage].style.display="block"}function catVideo(){stages[currentStage].style.display="none",currentStage=8,stages[currentStage].style.display="block"}function dogVideo(){stages[currentStage].style.display="none",currentStage=9,stages[currentStage].style.display="block"}function peopleVideo(){stages[currentStage].style.display="none",currentStage=10,stages[currentStage].style.display="block"}function standupVideo(){stages[currentStage].style.display="none",currentStage=11,stages[currentStage].style.display="block"}function pillContain(){stages[currentStage].style.display="none",currentStage=12,stages[currentStage].style.display="block"}function pillHelp(){stages[currentStage].style.display="none",currentStage=13,stages[currentStage].style.display="block"}function pillDrop(){stages[currentStage].style.display="none",currentStage=14,stages[currentStage].style.display="block"}function initAudioPlayer(){function a(){audio.paused?(audio.play(),playbtn.style.background="url(pause.svg) no-repeat"):(audio.pause(),playbtn.style.background="url(play.svg) no-repeat")}audio=new Audio,audio.src="audio/song1.mp3",audio.loop=!0,audio.pause(),playbtn=document.getElementById("playpausebtn"),playbtn.addEventListener("click",a)}function showResponse(){var a=inputBox.value;""==inputBox.value||(0==num?(output.innerHTML="Let me help you",inputBox.value="",inputBox.setAttribute("placeholder","..."),++num,setTimeout(changeQuestion,1e3)):1==num?(output.innerHTML=a+"? I know what might help... an ePill!",inputBox.value="",inputBox.setAttribute("placeholder","..."),++num,setTimeout(changeQuestion,2e3)):2==num?(output.innerHTML="An ePill instantly makes you happy, try one for yourself! Just click the pill button below.",inputBox.value="",inputBox.setAttribute("placeholder","..."),++num,setTimeout(changeQuestion,4e3)):3==num&&(inputBox.value="",inputBox.setAttribute("placeholder","..."),++num,setTimeout(changeQuestion,100)))}function changeQuestion(){inputBox.setAttribute("placeholder","Type here"),output.innerHTML=questions[num],4==num&&(inputBox.style.display="none")}function idleTimer(){function a(){window.location.href="index.html"}function b(){clearTimeout(c),c=setTimeout(a,6e4)}var c;window.onmousemove=b,window.onmousedown=b,window.onclick=b,window.onscroll=b,window.onkeypress=b}$(document).ready(function(){initCamera()});var stages=[];stages.push(document.getElementById("one")),stages.push(document.getElementById("two")),stages.push(document.getElementById("three")),stages.push(document.getElementById("four")),stages.push(document.getElementById("video-app")),stages.push(document.getElementById("mindfulness-app")),stages.push(document.getElementById("music-app")),stages.push(document.getElementById("chatbot-app")),stages.push(document.getElementById("cat-video")),stages.push(document.getElementById("dog-video")),stages.push(document.getElementById("people-video")),stages.push(document.getElementById("standup-video")),stages.push(document.getElementById("pill-popup")),stages.push(document.getElementById("pill-help")),stages.push(document.getElementById("pill-drop"));var currentStage=0;stages[currentStage].style.display="block",$("#analyse").one("click",function(){$("#analyse").unbind("click"),console.log("done 1 click"),$("#one").fadeOut("fast",function(){clickHandler(),$("#two").fadeIn("slow",function(){setTimeout(function(){$("#three").fadeIn()},1e4),setTimeout(function(){$("#three").fadeOut()},11e3),setTimeout(function(){$("#four").fadeIn()},11e3)})})}),$(".effect-8").one("click",function(){$(".effect-8").unbind("click"),$("#four").fadeOut("slow",function(){$("#video-app").fadeIn("slow",function(){})})}),$(".effect-9").on("click",function(){$(".effect-9").unbind("click"),$("#four").fadeOut("slow",function(){$("#mindfulness-app").fadeIn("slow",function(){})})}),$(".effect-10").click(function(){$(".effect-10").unbind("click"),$("#four").fadeOut("slow",function(){$("#music-app").fadeIn("slow",function(){})})}),$(".effect-11").click(function(){$(".effect-11").unbind("click"),$("#four").fadeOut("slow",function(){$("#chatbot-app").fadeIn("slow",function(){})})}),$(".effect-12").click(function(){$(".effect-12").unbind("click"),$("#chatbot-app").fadeOut("slow",function(){pillContain(),setTimeout(function(){$("#pill-drop").fadeIn()},5e3),setTimeout(function(){$("#pill-popup").fadeOut()},7e3),setTimeout(function(){$("#pill-help").fadeIn()},8e3)})}),$("#go-home").click(function(){$("#pill-help").fadeOut("slow",function(){$("#chatbot-app").fadeIn("slow",function(){})})});var audio,playbtn;window.addEventListener("load",initAudioPlayer);var questions=["Hello! How are you feeling?","What exactly is wrong?","Would you like to try one?","Can I help you with anything else?","Glad I could help! It was nice talking to you, have a great day! :)"],num=0,inputBox=document.querySelector("#ans"),output=document.querySelector("#result");output.innerHTML=questions[num],$(document).on("keypress",function(a){13==a.which&&showResponse()}),$("#ans").focus(),idleTimer();